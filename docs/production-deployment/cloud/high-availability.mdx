---
id: high-availability
slug: /cloud/high-availability
title: High availability namespaces.
sidebar_label: High Availability
sidebar_position: 5
tags:
  - high-availability
  - multi-region namespace
  - failover
  - availability
  - namespaces
---

:::tip Support, stability, and dependency info
- High Availability is in [Public Preview](/temporal/release-stages#public-preview) for Temporal Cloud.

:::
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>I kept high availability namespace in lower-case here, as the original doc did.
Is this correct?</span>

Temporal Cloud's high availability namespace feature introduces push-button multi-region availability for your Temporal Service.
This feature enables you to choose a standby region for a Temporal Namespace.
The service takes care of the complexity of replicating data from the active region to the standby region and failing over to the standby region when needed.


- [What is high availability?](/cloud/high-availability#high-availability-intro)
- [Why choose high availability?](/cloud/high-availability#why-high-availability)
- [Understanding failover and failover scenarios](/cloud/high-availability#failovers)
- [High availability SLA](/cloud/high-availability#sla)
- [Architecture overview](/cloud/high-availability#architecture)
- [Manage high-availability namespaces](/cloud/high-availability#manage-high-availability-namespaces)

## What is high availability? {#high-availability-intro}

A high availability namespace provides a single endpoint for a multi-region service.
This option offers a single logical namespace that runs in two physical regions, one active and one standby.
As Workflows progress in the active region, history events are asynchronously replicated to the standby region.

In case of an incident or outage in the active region, Temporal Cloud will "failover" to the standby region.
A failover means to switch the roles of the active and standby regions.
Temporal's high availability failovers enable existing Workflow Executions to keep running and new Executions to be initiated.

In the traditional definition of active/active replication, multiple nodes serve requests and accept writes simultaneously with strong synchronous data consistency.
High availability namespaces in Temporal Cloud allow two replicated namespaces (one active, one standby) to accept requests, but not simultaneously.
Requests are accepted, and Workflow history events are written to the active region and then asynchronously replicated to the standby region.

Before failover            |  After failover
:-------------------------:|:-------------------------:
![Before failover](/img/multi-region/before-failover.png)  |  ![After failover](/img/multi-region/after-failover.png)

## Why choose high availability? {#why-high-availability}

For a namespace in a single region, Temporal Cloud provides 99.99% availability and its contractual service level agreement (SLA) has a 99.9% guarantee against service errors.
For many applications, this is sufficient availability.
With this strategy, Temporal clients connect to a single namespace in a single AWS region.
This approach works well for workloads that need the availability provided by Temporal Cloud’s single-region namespaces.

High availability supports standby recovery.
It is deployed using a simple namespace setting.
All back-end deployment is completed by Temporal Cloud.

In the event of a regional failure, Temporal Cloud automatically fails over to the namespace in the secondary region.
When faced with network latency or other region-wide issues, failover can be deliberately triggered.


High availability advantages:

* No manual deployment or configuration needed with push button operation.
* Open workflows continue in a secondary region with minimal interruption and data loss.
* No changes required to workers and workflow starter code in setup and failover.
* 99.99% Contractual SLA.

## Understanding failover and failover scenarios {#failovers}

Consider an incident or outage that leads to elevated error rates or latency in the active region of a high availability namespace.
Under these circumstances, Temporal Cloud will initiate a namespace failover operation.
This operation shifts Workflow processing to a standby region, unaffected by the incident.
This allows both existing Workflows to progress and new Workflows to be created as the incident is addressed.


Customers who wish to test the set-up of their high availability namespace can manually trigger failovers using the UI, API, or CLI.
For most scenarios, we recommend you let Temporal handle failovers for you.

### Replication lag {#replication-lag}

When using high availability namespaces, the replication between regions is asynchronous.
Any updates to the workflow in the active region, and the history events associated with it, will be applied to the standby region with a short delay.
This delay is called the replication lag.
Temporal Cloud aims to provide a P95 replication delay of less than 1 minute.


Due to this delay, a [forced failover]((/cloud/high-availability#forced-failover) could cause workflows to rollback in progress or cause recently started Workflows to be absent until the region recovers.
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>FIXME: Add link to conflict resolution converage</span>
Temporal event versioning and conflict resolution mechanisms ensure that the eventual history of the Workflow is still replayable by the SDK.
Critical operations like Signals won't get lost.


### Failover scenarios

The Temporal Cloud failover mechanism supports several modes to execute namespace failovers.

Hybrid mode is the default.
These modes include:

#### Graceful failover (handover) {#graceful-failover}

In this mode, replication tasks are fully processed and drained.
Traffic to the namespace is paused before the failover to ensure no loss of progress or data conflicts.

This approach may result in a short period of unavailability with a default value of 10 seconds.

During this period, existing Workflows will stop progress.
That means state transitions will not happen and tasks will not be dispatched.
User requests like start/signal workflow will be rejected as operations are paused during handover.

This mode favors consistency over availability.

#### Forced failover {#forced-failover}

In this mode, a namespace is immediately activated in the standby region.
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>FIXME: Add link to conflict resolution converage</span>
Events not yet replicated due to [replication lag](/cloud/high-availability#replication-lag) will undergo conflict resolution upon reaching the new active region.
This mode prioritizes availability over consistency.

#### Hybrid failover mode {#hybrid-failover}

While graceful failovers are normally preferred for consistency, they are not always practical.
The hybrid failover mode (the default mode) limits graceful failover attempts to 10 seconds or less.
If the graceful approach does not resolve the issue, Temporal Cloud automatically switches to a forced failover.
This strategy balances consistency and availability requirements.

<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>FIXME: FIXME: Add links to Triggering a failover, Worker deployment, and Routing (probably re-named?  traffic after failovers?</span>
See the sections on triggering a failover, Worker deployment, and routing for more information.

## High availability SLA {#high-availability-sla}

High availability namespaces offer 99.99% availability.
This is enforced by an SLA on [service error rates](https://docs.temporal.io/cloud/sla).
Our system is designed to limit data loss after recovery when the incident triggering the failover is resolved.

The recovery point objective ([RPO](https://en.wikipedia.org/wiki/Disaster_recovery#Recovery_Point_Objective)) is near-zero.
There may be a short period of time—the [replication lag](/cloud/high-availability#replication-lag)—during the incident when some data may be unavailable.
If the active region is unable to reach the standby region, the data will be unavailable until the network issue is fixed and data has finished replicating.
In a disaster scenario in which the data on the hard drives in the active region are not recoverable, the duration of data loss can be as high as the replication lag at the time of disaster.

We've designed Temporal Cloud to proactively respond to incidents by triggering failovers.
Our recovery time objective ([RTO](https://en.wikipedia.org/wiki/Disaster_recovery#Recovery_Time_Objective)) is 20 minutes or less per incident.
We aim to reduce this RTO in the future.

### Regional availability {#regional-availability}

High availability namespaces are available in all existing [Temporal Cloud regions](/cloud/service-availability#regions).

:::info
- Namespace pairing is limited to regions within the same continent.
South America is excluded as only one region is available.


:::

## Architecture overview {#architecture}

High availability namespaces enable replication of Namespace metadata and Workflow Executions across connected regions.
This redundancy, plus the added failover capability, provides measurable stability when dealing with outages.

A high availability namespace is normally in a single region at any moment.
The passive region assumes a standby role.
The only exception occurs in the event of a network partition.

In this event, an operator may elect to promote a standby region to active status.
Be aware that this action will temporarily result in both regions being active.
Once the network partition is resolved and communication between the regions is restored, a conflict resolution algorithm determines which region continues as the active one.
This ensures only one region remains active.

### Metadata replication {#metadata-replication}

Updates to a high availability namespace record are replicated across regions.
This includes configurations such as retention periods, Search Attributes, and other settings, 
This process ensures that all regions will eventually share a consistent and unified view of the namespace metadata.

:::info
- A namespace failover, which involves changing the "active region" field of a Namespace record, is an update.
  It will be replicated via the same namespace metadata mechanism.

:::

### Workflow execution replication {#workflow-execution-replication}

Certain Workflow operations are limited to the active region:

* Workflows in a multi-region namespace can only be mutated in the active region.
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Q: Is there a better way to explain what "mutated" means?</span>
* Workflow Tasks and Activity Tasks are only dispatched from the active region, and thus forward progress will only be made there.

This means that certain requests, such as Start Workflow and Signal Workflow can only be processed in the active region.

Standby regions may receive API requests from Clients and Workers.
They automatically forward these requests to the active cluster for execution.

This feature provides an “all-active” experience for Temporal users.
It helps ensure there's no downtime during Namespace failover.
There's a short time window from when a standby region becomes the active region to when Clients and Workers receive a DNS update.
During this time requests forward from the now passive active region to the active standby region.

As Workflow Executions progress and are operated on, replication tasks created in the active region are dispatched to the standby region.
The processing of these replication tasks ensures that the standby region undergoes the same state transitions as the active region.
This enables the replicated tasks to synchronize and achieve the same state.

Standby regions do not distribute Workflow or Activity Tasks.
Instead, they perform verification tasks to confirm that intended operations are executed and Workflows reach the desired state.
This mechanism ensures consistency and reliability in the replication process across Temporal regions.

### Conflict Resolution {#conflict-resolution}

High availability namespaces rely on asynchronous event replication across Temporal regions.
In the event of a non-graceful failover, replication lag may result in a temporary setback in workflow progress.

<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Is there a good link for "at most once" and "at least once" semantics? A Kafka source? https://docs.confluent.io/kafka/design/delivery-semantics.html?</span>

Single-region Namespaces, which can provide _at-most-once_ semantics for the execution of Activities (when [Maximum Attempts](https://docs.temporal.io/retry-policies#maximum-attempts) is set to 0).
High availability namespaces can only provide _at-least-once_ semantics for execution of Activities.
Completed Activities _may_ be dispatched again in the newly active region, leading to repeated executions.

<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>I removed "This implies", but I think there's something missing here</span>

When a Workflow Execution is updated in a new region following a failover, events from the previous cluster arriving post-failover cannot be directly applied.
At this point, Temporal Cloud forks the Workflow History.
It creates a new branch history for execution, and begins the conflict resolution process.

The Temporal Service ensures that workflow histories remain valid and are replayable by SDKs post-failover or after conflict resolution.
This capability is crucial for workflows to continue to make forward progress.

<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>I did not include the pricing section; Should it be here? Should namespaces (and/or high-availability) be uppercased now that we're talking about programmatic and UI customization? I AM ROUGHING OUT THIS SECTION. I am still deciding how to best frame it.</span>

## Manage high-availability namespaces {#manage-high-availability-namespaces}
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Intro</span>

### Create high-availability namespaces {#create}
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Intro</span>

The following sections show how to create high-availability namespaces

#### Create a high-availability namespace with the Temporal Cloud Web UI

During Namespace creation, specify a region for the Namespace to be created in, as you normally would.
Select the “upgrade to a high-availability namespace” option.
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Source still referred to multi-region; Will the WebUI be updated?</span>

#### Use the Temporal 'tcld' CLI utility to create a high-availability namespace

Enter the following at the command line.
Include both regions to add.
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Correct?</span>

```
tcld namespace create --region <region list> 
```

The utility responds:

```
[y/n] Adding a standby region improves availability and increases the cost.
Do you want to proceed?
```

Confirm with "y" to continue.

#### Create a high-availability namespace with API calls

<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Fill this out; Something about no confirmation; Something about South America; Something about co-located regions in the same sector/area</span>

### Add a new region to a namespace {#add-regions}

Use [`AddNamespaceRegion`](https://github.com/temporalio/api-cloud/pull/19) to add additional Namespace regions to an existing Namespace.

You can upgrade an existing single-region Namespace to a multi-region Namespace by adding a standby region.

#### Add a new region using the Temporal Cloud Web UI

To upgrade an existing Namespace to a multi-region namespace:

1. Navigate to the Namespace
1. Select the “Upgrade Namespace” button.
1. Select the standby region you want to add to this Namespace.

You will see an estimated time for replication.
This time is based on your selection and the size and scale of Workflows in your namespace, 

#### Add a new region using the Temporal 'tcld' CLI utility

At the command line, enter:

```
tcld namespace add --region <region list>
```

The utility responds:

```
[y/n] Adding a standby region improves availability and increases the cost.
It will take an estimated <x amount of time> for this operation.
Do you still want to proceed?
```

Confirm with "y".

#### Add a new region programatically using the Temporal SDK APIs

See [`AddNamespaceRegion`](https://github.com/temporalio/api-cloud/pull/19)
<span style={{ backgroundColor: 'rgb(255, 255, 102)', fontWeight: 'bold' }}>Fill this in.</span>

