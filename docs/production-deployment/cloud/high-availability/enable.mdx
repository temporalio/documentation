---
id: enable
title: Enable High Availability
sidebar_label: Enable HA
slug: /cloud/high-availability/enable
description: Get started with HA features
---

import { ToolTipTerm } from '@site/src/components';

:::tip Support, stability, and dependency info

Same-region Replication and Multi-cloud Replication are in [Public Preview](/evaluate/development-production-features/release-stages#public-preview).

Multi-cloud Replication is in [General Availability](/evaluate/development-production-features/release-stages#general-availability)

:::

You can enable High Availability features ([Single-region Replication](/cloud/high-availability#same-region-replication), [Multi-region Replication](/cloud/high-availability#multi-region-replication), or [Multi-cloud Replication](/cloud/high-availability#multi-cloud-replication)) for a new or existing Namespace by adding a replica.
When you add a replica, Temporal Cloud begins asynchronously replicating ongoing and existing Workflow Executions.

Not all replication options are available in all regions. See the [region documentation](/cloud/regions) for the replication options available in each region.

Using private network connectivity with a HA namespace requires extra setup. See [Connectivity for HA](/cloud/high-availability/ha-connectivity).

There are charges associated with Replication and enabling High Availability features.
For pricing details, visit Temporal Cloud's [Pricing](/cloud/pricing) page.

## Create a Namespace with High Availability features {#create}

To create a new Namespace with High Availability features, you can use the Temporal Cloud UI or the tcld command line utility.

<Tabs>

<TabItem value="webui" label="Web UI">

    1. Visit Temporal Cloud in your Web browser.
    1. During Namespace creation, specify the primary [region](/cloud/regions) for the Namespace.
    1. Select "Add a replica".
    1. Choose the [region](/cloud/regions) for the replica.

    The web interface will present an estimated time for replication to complete.
    This time is based on your selection and the size and scale of the Workflows in your Namespace.

</TabItem>

<TabItem value="tcldcli" label="tcld">

At the command line, enter:

```
tcld namespace create \
   --namespace <namespace_id>.<account_id> \
   --region <primary_region> \
   --region <replica_region>
```

Specify the [region codes](/cloud/regions) as arguments to the two `--region` flags.

- Using the same region replicates to an isolation domain within that region.
- Using a different region replicates across regions.

If using API key authentication with the `--api-key` flag, you must add it directly after the tcld command and before `namespace create`.

</TabItem>

</Tabs>

Temporal Cloud sends an email alert to all Namespace Admins once your Namespace replica is ready for use.

## Add High Availability to an existing Namespace {#upgrade}

A replica can be added after a namespace has already been created.

<Tabs>

<TabItem value="webui" label="Web UI">

1. Visit Temporal Cloud Namespaces in your Web browser.
1. Navigate to the Namespace details page.
1. Select the “Add a replica” button.
1. Choose the [region](/cloud/regions) for the replica.

The web interface will present an estimated time for replication to complete.
This time is based on your selection and the size and scale of the Workflows in your Namespace.

Temporal Cloud sends an email alert to all Namespace Admins once your Namespace replica is ready for use.

</TabItem>

<TabItem value="tcldcli" label="tcld">

At the command line, enter:

```
tcld namespace add-region \
   --namespace <namespace_id>.<account_id> \
   --region <replica_region>
```

Specify the [region code](/cloud/regions) of the region where you want to create the replica as an argument to the `--region` flag.

If using API key authentication with the `--api-key` flag, you must add it directly after the tcld command and before `namespace add-region`.

Temporal Cloud sends an email alert once your Namespace is ready for use.

</TabItem>

</Tabs>

## Monitoring replication

### Replica status

You can monitor your replica status with the Temporal Cloud UI.
If the replica is unhealthy, Temporal Cloud diables the “Trigger a failover” option to prevent failing over to an unhealthy replica.
An unhealthy replica might be due to:

- **Data synchronization issues:** The replica fails to remain in sync with the primary due to network or performance problems.
- **Replication lag:** The replica falls behind the primary, causing it to be out of sync.
- **Network issues:** Loss of communication between the replica and the primary causes problems.
- **Failed health checks:** If the replica fails health checks, it’s marked as unhealthy.

These issues prevent the replica from being used during a failover, ensuring system stability and consistency.

### Replication lag metric

Temporal Cloud’s High Availability features use asynchronous replication between the primary and the replica.
Workflow updates in the primary, along with associated History Events, are transmitted to the replica.
Replication lag refers to the transmission delay of Workflow updates and history events from the primary to the replica.

:::tip

Temporal Cloud strives to maintain a <ToolTipTerm term="P95" /> replication lag of less than 1 minute.
In this context, P95 means 95% of updates are processed faster than this limit.

:::

A forced failover, when there is significant replication lag, increases the likelihood of rolling back Workflow progress.
Always check the replication lag metrics before initiating a failover.

Temporal Cloud emits three replication lag-specific [metrics](/production-deployment/cloud/metrics/reference#replication-lag).
The following samples demonstrate how you can use these metrics to monitor and explore replication lag:

**P99 replication lag histogram**:

```
histogram_quantile(0.99, sum(rate(temporal_cloud_v0_replication_lag_bucket[$__rate_interval])) by (temporal_namespace, le))
```

**Average replication lag**:

```
sum(rate(temporal_cloud_v0_replication_lag_sum[$__rate_interval])) by (temporal_namespace)
/
sum(rate(temporal_cloud_v0_replication_lag_count[$__rate_interval])) by (temporal_namespace)
```

When a Namespace is using a replica, you may notice that the Action count in `temporal_cloud_v0_total_action_count` is 2x what it was before adding a replica.
This happens because Actions are replicated; they occur on both the primary and the replica.

### Failover audit log

When Temporal triggers failovers, the [audit log](/cloud/audit-logging) will update with details.

Look for `"operation": "FailoverNamespace"` in the logs.


## Change a replica location {#changing}

:::caution

We discourage changing the location of your replica for deployed applications, except under exceptional circumstances.
Changing the location of your Namespace replica will result in a mandatory 7-day waiting period before you can re-enable High Availability Namespace features.

:::

Temporal Cloud can't change replica locations directly.
To update the location, you need to remove the current replica and add a new one.
Follow these steps to change the replica location:

1. [Remove your replica](#discontinuing).
   This disables High Availability for your Namespace.
2. Wait through the required 7-day waiting period.
3. [Add a new replica](#upgrade) to your Namespace.

You will receive an email alert once your Namespace is ready for use.

## Discontinue High Availability features {#discontinuing}

Removing a Namespace replica disables High Availability and automatic failover features.
Follow these steps to disable these features and end High Availability charges:

<Tabs>

<TabItem value="webui" label="Web UI">

1. Navigate to the Namespace details page in Temporal Cloud
1. Select the option to "Remove Replica" on the "Region" card.

</TabItem>

<TabItem value="tcldcli" label="tcld">

At the command line, enter:

```
tcld namespace delete-region \
    --namespace <namespace_id>.<account_id> \
    --region <replica_region>
```

If using API key authentication with the `--api-key` flag, you must add it directly after the tcld command and before `namespace delete-region`

</TabItem>

</Tabs>

After following these instructions, Temporal Cloud deletes the replica.
Your Namespace will no longer use High Availability features and you will no longer be charged for this feature.

:::note

After removing a replica, Temporal Cloud can't re-enable replication for a given Namespace for seven days.

:::

